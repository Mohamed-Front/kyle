import{_ as R,M as z,J as B,k as G,i as o,j as L,o as u,c,a as t,h as r,g as l,N as m,b as h,H as S,G as U,L as A,s as C,A as E,v as J,E as b,y as O}from"./index-dab9be7b.js";const W={class:"max-w-4xl mx-auto p-6",dir:"rtl"},q={key:0,class:"flex justify-center py-20"},H={key:1,class:"bg-white rounded-2xl shadow-2xl overflow-hidden"},K={class:"p-8"},Q={key:0,class:"space-y-6"},X=["src"],Y={class:"flex justify-center gap-4"},Z={class:"cursor-pointer"},ee={key:1,class:"space-y-5"},te={key:0,class:"mt-6 text-center"},ae=["src"],se={class:"flex justify-center gap-6 pt-12"},le={__name:"edit",setup(oe){const x=z(),V=B(),n=G(),w=V.params.id,p=o(""),_=o(!1),v=o(!1),f=o(null),i=o(null),y=o(""),g=o(!1),j=async()=>{_.value=!0;try{const e=(await C.get(`/api/team/${w}`)).data.data;if(p.value=e.name||"",e.media&&e.media.length>0){const s=e.media.find(d=>d.name==="member_image"||d.name==="avatar"||d.name==="profile");s&&(y.value=s.url,i.value=s.url)}}catch{n.add({severity:"error",summary:"فشل التحميل",detail:"لا يمكن جلب بيانات العضو",life:5e3}),x.push({name:"team"})}finally{_.value=!1}},F=a=>{a.preventDefault(),g.value=!0},N=()=>g.value=!1,T=a=>{a.preventDefault(),g.value=!1;const e=a.dataTransfer.files[0];e&&e.type.startsWith("image/")?D(e):n.add({severity:"warn",summary:"خطأ",detail:"يرجى رفع صورة فقط",life:3e3})},k=a=>{const e=a.target.files[0];e&&D(e)},D=a=>{if(a.size>10*1024*1024){n.add({severity:"warn",summary:"حجم كبير",detail:"الحد الأقصى 10 ميجابايت",life:4e3});return}f.value=a;const e=new FileReader;e.onload=s=>i.value=s.target.result,e.readAsDataURL(a)},$=()=>{f.value=null,i.value=y.value;const a=document.querySelector('input[type="file"]');a&&(a.value="")},I=async()=>{var e,s,d;if(!((e=p.value)!=null&&e.trim())){n.add({severity:"error",summary:"مطلوب",detail:"اسم العضو مطلوب",life:3e3});return}v.value=!0;const a=new FormData;a.append("name",p.value.trim()),a.append("_method","POST"),f.value&&a.append("member_image",f.value);try{await C.post(`/api/team/${w}`,a,{headers:{"Content-Type":"multipart/form-data"}}),n.add({severity:"success",summary:"تم التحديث!",detail:"تم تعديل بيانات العضو بنجاح",life:4e3}),setTimeout(()=>x.push({name:"team"}),1500)}catch(P){const M=((d=(s=P.response)==null?void 0:s.data)==null?void 0:d.message)||"فشل تحديث العضو";n.add({severity:"error",summary:"خطأ",detail:M,life:5e3})}finally{v.value=!1}};return L(()=>{j()}),(a,e)=>(u(),c(A,null,[t("div",W,[_.value?(u(),c("div",q,[r(l(E))])):(u(),c("div",H,[e[6]||(e[6]=t("div",{class:"bg-gradient-to-l from-[#2c3e50] to-[#34495e] px-8 py-7"},[t("h1",{class:"text-3xl font-bold text-white text-center"}," تعديل عضو الفريق "),t("p",{class:"text-center text-white/90 mt-2 text-lg"}," يمكنك تعديل الاسم وتغيير الصورة الشخصية ")],-1)),t("div",K,[t("form",{onSubmit:m(I,["prevent"]),class:"space-y-10"},[t("div",null,[e[2]||(e[2]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[h(" اسم العضو "),t("span",{class:"text-red-500"},"*")],-1)),r(l(J),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),placeholder:"أدخل اسم العضو",class:"w-full text-lg py-3"},null,8,["modelValue"])]),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-bold text-gray-700 mb-3"},[h(" صورة العضو "),t("span",{class:"text-gray-500"},"(اختياري للتغيير)")],-1)),t("div",{onDragover:m(F,["prevent"]),onDragleave:m(N,["prevent"]),onDrop:m(T,["prevent"]),class:S(["relative border-3 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all duration-300 shadow-md",g.value?"border-blue-600 bg-blue-50/70":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"])},[t("input",{type:"file",accept:"image/*",onChange:k,class:"absolute inset-0 opacity-0 cursor-pointer z-10"},null,32),i.value?(u(),c("div",Q,[t("img",{src:i.value,alt:"صورة العضو",class:"mx-auto w-64 h-64 rounded-full object-cover shadow-2xl border-8 border-white"},null,8,X),t("div",Y,[r(l(b),{type:"button",label:"إزالة الصورة الجديدة",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:m($,["stop"])}),t("label",Z,[r(l(b),{label:"تغيير الصورة",icon:"pi pi-camera",outlined:""}),t("input",{type:"file",accept:"image/*",onChange:k,class:"hidden"},null,32)])])])):(u(),c("div",ee,[...e[3]||(e[3]=[t("i",{class:"pi pi-user text-7xl text-gray-400"},null,-1),t("p",{class:"text-xl font-bold text-gray-700"},[t("span",{class:"text-blue-600 font-extrabold"},"اضغط لرفع صورة جديدة"),h(" أو اسحب وأفلت ")],-1),t("p",{class:"text-sm text-gray-500"}," PNG، JPG، WebP • حتى 10 ميجابايت ",-1)])]))],34),y.value&&!i.value?(u(),c("div",te,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-600 mb-3"},"الصورة الحالية:",-1)),t("img",{src:y.value,class:"mx-auto w-48 h-48 rounded-full object-cover border-4 border-gray-200"},null,8,ae)])):U("",!0)]),t("div",se,[r(l(b),{type:"button",label:"إلغاء",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:e[1]||(e[1]=s=>l(x).back()),disabled:v.value,class:"px-10 py-3 text-lg"},null,8,["disabled"]),r(l(b),{type:"submit",label:"حفظ التعديلات",icon:"pi pi-check",loading:v.value,class:"px-12 py-3 text-lg font-bold"},null,8,["loading"])])],32)])]))]),r(l(O),{position:"top-right"})],64))}},ne=R(le,[["__scopeId","data-v-a609b8a3"]]);export{ne as default};
