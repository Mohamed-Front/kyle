import{_ as B,r as _,u as L,o as M,a as x,c as f,b as i,d as e,w as g,j as n,e as E,s as T,k as U,l as P,m as v,q as z,v as $,x as A,y as q,z as O,A as p,t as m,F as R,B as G,i as j,C as H,D as J,p as K,f as Q}from"./index-5ffc309d.js";import{N as W}from"./nav-cdb953ae.js";import{F as Y}from"./footer-31bfcda1.js";const l=y=>(K("data-v-46ec5606"),y=y(),Q(),y),Z={class:"min-h-screen flex flex-col bg-gray-50"},ee={class:"flex-grow p-4 md:p-6 lg:p-8"},te={class:"max-w-5xl mx-auto"},se=["onSubmit"],ae=l(()=>e("div",{class:"col-span-2 text-center"},[e("h1",{class:"text-2xl sm:text-3xl font-bold text-[#2E5731] mb-2"},"تقديم شكوى"),e("p",{class:"text-gray-600 mb-4"},"املأ النموذج أدناه لتقديم شكوتك")],-1)),le={class:"col-span-2 lg:col-span-1"},oe=l(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" الاسم "),e("span",{class:"text-red-500"},"*")],-1)),ie={class:"p-inputgroup"},de={class:"col-span-2 lg:col-span-1"},ne=l(()=>e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" البريد الإلكتروني "),e("span",{class:"text-red-500"},"*")],-1)),re={class:"p-inputgroup"},ce={class:"col-span-2 lg:col-span-1"},ue=l(()=>e("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" رقم الهاتف "),e("span",{class:"text-red-500"},"*")],-1)),me={class:"p-inputgroup"},pe={class:"col-span-2 lg:col-span-1"},_e=l(()=>e("label",{for:"date",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" التاريخ "),e("span",{class:"text-red-500"},"*")],-1)),ve={class:"p-inputgroup"},he={class:"col-span-2 lg:col-span-1"},xe=l(()=>e("label",{for:"type",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" نوع الشكوى "),e("span",{class:"text-red-500"},"*")],-1)),fe={class:"p-inputgroup"},ye={class:"col-span-2 lg:col-span-1"},ge=l(()=>e("label",{for:"authority_id",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" الجهة "),e("span",{class:"text-red-500"},"*")],-1)),be={class:"p-inputgroup"},we={class:"col-span-2 lg:col-span-1"},Ve=l(()=>e("label",{for:"complaint",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" نص الشكوى "),e("span",{class:"text-red-500"},"*")],-1)),ke={class:"p-inputgroup"},Xe={class:"text-center mt-2"},Ee={class:"p-4 sm:p-6"},Ie=l(()=>e("div",{class:"text-center"},[e("h1",{class:"text-2xl sm:text-3xl font-bold text-[#2E5731] mb-2"},"استعلام عن شكوى"),e("p",{class:"text-gray-600 mb-6"},"أدخل معلومات الشكوى للاستعلام عن حالتها")],-1)),Ue={class:"grid grid-cols-1 gap-4 max-w-5Xl mx-auto"},$e=l(()=>e("label",{for:"complaintId",class:"block text-sm font-medium text-gray-700 mb-1"},[p(" رقم الشكوى "),e("span",{class:"text-red-500"},"*")],-1)),qe={class:"p-inputgroup"},je=l(()=>e("label",{for:"queryEmail",class:"block text-sm font-medium text-gray-700 mb-1"},"البريد الإلكتروني",-1)),Ce={class:"p-inputgroup"},Se=l(()=>e("label",{for:"queryPhone",class:"block text-sm font-medium text-gray-700 mb-1"},"رقم الهاتف",-1)),Fe={class:"p-inputgroup"},Ne={class:"text-center mt-2"},De={key:0,class:"mt-8 max-w-4xl mx-auto"},Be=l(()=>e("div",{class:"bg-gradient-to-r from-[#2E5731] to-[#3a7340] text-white rounded-t-xl p-4 shadow-lg"},[e("h2",{class:"text-xl font-bold flex items-center justify-center sm:justify-start"},[e("i",{class:"pi pi-info-circle mr-2"}),e("span",null,"تفاصيل الشكوى")])],-1)),Le={class:"bg-white rounded-b-xl shadow-lg border border-gray-200 overflow-hidden"},Me={class:"px-4 sm:px-6 py-3 border-b border-gray-200 bg-gray-50 flex justify-center sm:justify-start"},Te=l(()=>e("i",{class:"pi pi-circle-fill text-xs mr-1"},null,-1)),Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 sm:p-6"},ze={class:"space-y-4"},Ae=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"رقم المرجع",-1)),Oe={class:"mt-1 text-lg font-semibold text-[#2E5731]"},Re=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"الاسم",-1)),Ge={class:"mt-1 text-lg font-semibold"},He=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"البريد الإلكتروني",-1)),Je={class:"mt-1 text-lg break-all"},Ke={class:"space-y-4"},Qe=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"رقم الهاتف",-1)),We={class:"mt-1 text-lg"},Ye=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"تاريخ الشكوى",-1)),Ze={class:"mt-1 text-lg"},et=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"نوع الشكوى",-1)),tt={class:"mt-1 text-lg"},st=l(()=>e("h3",{class:"text-sm font-medium text-gray-500"},"الجهة",-1)),at={class:"mt-1 text-lg"},lt={class:"px-4 sm:px-6 pb-6"},ot=l(()=>e("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"نص الشكوى",-1)),it={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},dt={class:"whitespace-pre-line"},nt={key:0,class:"px-4 sm:px-6 pb-6"},rt=l(()=>e("h3",{class:"text-sm font-medium text-gray-500 mb-4"},"سير الإجراءات",-1)),ct={class:"relative"},ut=l(()=>e("div",{class:"absolute left-4 top-0 h-full w-0.5 bg-[#2E5731]"},null,-1)),mt={class:"flex items-start"},pt=l(()=>e("div",{class:"absolute left-0 flex h-8 w-8 items-center justify-center rounded-full bg-[#2E5731] ring-4 ring-[#2E5731]/20"},[e("i",{class:"pi pi-check text-white text-xs"})],-1)),_t={class:"flex-1 rounded-lg bg-white p-4 shadow-sm border border-gray-200"},vt={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start"},ht={class:"font-medium text-gray-900"},xt={class:"text-xs text-gray-500 mt-1 sm:mt-0"},ft={setup(y){const b=_([]),r=L(),w=_(0),V=_(!1),k=_(!1),C=()=>{E.get("api/complaint/get/create/data").then(o=>{b.value=o.data.data.authorities})},a=_({name:"",email:"",phone:"",date:"",complaint:"",type:null,authority_id:null}),I=_([{label:"استفسار عام",value:1},{label:"شكوى",value:2},{label:"اقتراح",value:3},{label:"طلب خدمة",value:4}]),S=o=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o),F=o=>/^[0-9]{10}$/.test(o),N=async()=>{if(!a.value.name){r.add({severity:"warn",summary:"خطأ",detail:"حقل الاسم مطلوب",life:3e3});return}if(a.value.email){if(!S(a.value.email)){r.add({severity:"warn",summary:"خطأ",detail:"البريد الإلكتروني غير صالح",life:3e3});return}}else{r.add({severity:"warn",summary:"خطأ",detail:"حقل البريد الإلكتروني مطلوب",life:3e3});return}if(a.value.phone){if(!F(a.value.phone)){r.add({severity:"warn",summary:"خطأ",detail:"رقم الهاتف يجب أن يتكون من 10 أرقام",life:3e3});return}}else{r.add({severity:"warn",summary:"خطأ",detail:"حقل رقم الهاتف مطلوب",life:3e3});return}if(!a.value.date){r.add({severity:"warn",summary:"خطأ",detail:"حقل التاريخ مطلوب",life:3e3});return}if(!a.value.type){r.add({severity:"warn",summary:"خطأ",detail:"حقل نوع الشكوى مطلوب",life:3e3});return}if(!a.value.authority_id){r.add({severity:"warn",summary:"خطأ",detail:"حقل الجهة مطلوب",life:3e3});return}if(!a.value.complaint){r.add({severity:"warn",summary:"خطأ",detail:"حقل نص الشكوى مطلوب",life:3e3});return}V.value=!0;try{const o=await E.post("/api/complaint",a.value);r.add({severity:"success",summary:"تم الإرسال",detail:"تم إرسال شكواك بنجاح!",life:3e3}),a.value={name:"",email:"",phone:"",date:"",complaint:"",type:null,authority_id:null},w.value=1}catch(o){let s="حدث خطأ أثناء إرسال الشكوى. حاول مرة أخرى.";o.response&&o.response.data&&o.response.data.message?s=o.response.data.message:o.response&&o.response.data&&o.response.data.errors&&(s=Object.values(o.response.data.errors).flat().join(" ")),r.add({severity:"error",summary:"خطأ",detail:s,life:5e3})}finally{V.value=!1}},u=_({complaintId:"",email:"",phone:""}),d=_(null),D=async()=>{var o,s;if(!u.value.complaintId){r.add({severity:"warn",summary:"خطأ",detail:"يرجى إدخال رقم الشكوى",life:3e3});return}k.value=!0;try{const t={};u.value.email&&(t.email=u.value.email),u.value.phone&&(t.phone=u.value.phone);const c=(await E.get(`/api/complaint/get/by/${u.value.complaintId}`,{params:t})).data.data;d.value={id:c.id||"غير متوفر",number:c.number||"غير متوفر",name:c.name||"غير متوفر",email:c.email||"غير متوفر",phone:c.phone||"غير متوفر",date:c.date?new Date(c.date).toLocaleDateString("ar-SA"):"غير متوفر",complaint:c.complaint||"غير متوفر",type:c.type?(o=I.value.find(X=>X.value===c.type))==null?void 0:o.label:"غير محدد",authority_id:c.authority_id?(s=b.value.find(X=>X.id===c.authority_id))==null?void 0:s.name:"غير محدد",status_description:c.status_description||"قيد المعالجة",procedures:c.procedures||[]},r.add({severity:"success",summary:"تم الاستعلام",detail:"تم العثور على الشكوى بنجاح!",life:3e3})}catch(t){let h="حدث خطأ أثناء الاستعلام عن الشكوى. حاول مرة أخرى.";t.response&&t.response.data&&t.response.data.message?h=t.response.data.message:t.response&&t.response.status===404&&(h="لم يتم العثور على شكوى بهذا الرقم"),r.add({severity:"error",summary:"خطأ",detail:h,life:5e3}),d.value=null}finally{k.value=!1}};return M(()=>{C()}),(o,s)=>(x(),f("div",Z,[i(W),e("main",ee,[e("div",te,[i(n(H),{class:"shadow-2xl rounded-xl overflow-hidden animate-fade-in"},{content:g(()=>[i(n(T),{activeIndex:w.value,"onUpdate:activeIndex":s[10]||(s[10]=t=>w.value=t),class:"mb-6"},{default:g(()=>[i(n(U),{header:"تقديم شكوى"},{default:g(()=>[e("form",{onSubmit:P(N,["prevent"]),class:"grid grid-cols-2 lg:grid-cols-2 gap-4 p-4 sm:p-2"},[ae,e("div",le,[oe,e("div",ie,[i(n(v),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":s[0]||(s[0]=t=>a.value.name=t),class:"w-full",placeholder:"أدخل اسمك الكامل"},null,8,["modelValue"])])]),e("div",de,[ne,e("div",re,[i(n(v),{id:"email",modelValue:a.value.email,"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.email=t),type:"email",class:"w-full",placeholder:"example@domain.com"},null,8,["modelValue"])])]),e("div",ce,[ue,e("div",me,[i(n(v),{id:"phone",modelValue:a.value.phone,"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.phone=t),type:"tel",class:"w-full",placeholder:"05XXXXXXXX"},null,8,["modelValue"])])]),e("div",pe,[_e,e("div",ve,[i(n(z),{id:"date",modelValue:a.value.date,"onUpdate:modelValue":s[3]||(s[3]=t=>a.value.date=t),class:"w-full",dateFormat:"yy/mm/dd",placeholder:"اختر التاريخ"},null,8,["modelValue"])])]),e("div",he,[xe,e("div",fe,[i(n($),{id:"type",modelValue:a.value.type,"onUpdate:modelValue":s[4]||(s[4]=t=>a.value.type=t),options:I.value,optionLabel:"label",optionValue:"value",placeholder:"اختر نوع الشكوى",class:"w-full"},null,8,["modelValue","options"])])]),e("div",ye,[ge,e("div",be,[i(n($),{id:"authority_id",modelValue:a.value.authority_id,"onUpdate:modelValue":s[5]||(s[5]=t=>a.value.authority_id=t),options:b.value,optionLabel:"name",optionValue:"id",placeholder:"اختر الجهة",class:"w-full"},null,8,["modelValue","options"])])]),e("div",we,[Ve,e("div",ke,[i(n(A),{id:"complaint",modelValue:a.value.complaint,"onUpdate:modelValue":s[6]||(s[6]=t=>a.value.complaint=t),rows:"5",class:"w-full",placeholder:"أدخل تفاصيل شكواك هنا..."},null,8,["modelValue"])])]),e("div",Xe,[i(n(q),{type:"submit",label:"إرسال الشكوى",icon:"pi pi-send",class:"px-6 py-3 bg-gradient-to-r from-[#2E5731] to-[#3a7340] hover:from-[#224225] hover:to-[#2E5731] text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",loading:V.value},null,8,["loading"])])],40,se)]),_:1}),i(n(U),{header:"استعلام عن شكوى"},{default:g(()=>[e("div",Ee,[Ie,e("div",Ue,[e("div",null,[$e,e("div",qe,[i(n(v),{id:"complaintId",modelValue:u.value.complaintId,"onUpdate:modelValue":s[7]||(s[7]=t=>u.value.complaintId=t),class:"w-full",placeholder:"أدخل رقم الشكوى",required:""},null,8,["modelValue"])])]),e("div",null,[je,e("div",Ce,[i(n(v),{id:"queryEmail",modelValue:u.value.email,"onUpdate:modelValue":s[8]||(s[8]=t=>u.value.email=t),type:"email",class:"w-full",placeholder:"example@domain.com"},null,8,["modelValue"])])]),e("div",null,[Se,e("div",Fe,[i(n(v),{id:"queryPhone",modelValue:u.value.phone,"onUpdate:modelValue":s[9]||(s[9]=t=>u.value.phone=t),type:"tel",class:"w-full",placeholder:"05XXXXXXXX"},null,8,["modelValue"])])]),e("div",Ne,[i(n(q),{onClick:D,label:"استعلام",icon:"pi pi-search",class:"px-6 py-3 bg-gradient-to-r from-[#2E5731] to-[#3a7340] hover:from-[#224225] hover:to-[#2E5731] text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",loading:k.value},null,8,["loading"])])]),d.value?(x(),f("div",De,[Be,e("div",Le,[e("div",Me,[e("span",{class:O(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",{"bg-yellow-100 text-yellow-800":d.value.status_description==="قيد المعالجة","bg-green-100 text-green-800":d.value.status_description==="مكتملة","bg-red-100 text-red-800":d.value.status_description==="ملغاة"}])},[Te,p(" "+m(d.value.status_description),1)],2)]),e("div",Pe,[e("div",ze,[e("div",null,[Ae,e("p",Oe,m(d.value.number),1)]),e("div",null,[Re,e("p",Ge,m(d.value.name),1)]),e("div",null,[He,e("p",Je,m(d.value.email),1)])]),e("div",Ke,[e("div",null,[Qe,e("p",We,m(d.value.phone),1)]),e("div",null,[Ye,e("p",Ze,m(d.value.date),1)]),e("div",null,[et,e("p",tt,m(d.value.type||"غير محدد"),1)]),e("div",null,[st,e("p",at,m(d.value.authority_id||"غير محدد"),1)])])]),e("div",lt,[ot,e("div",it,[e("p",dt,m(d.value.complaint),1)])]),d.value.procedures&&d.value.procedures.length?(x(),f("div",nt,[rt,e("div",ct,[ut,(x(!0),f(R,null,G(d.value.procedures,(t,h)=>(x(),f("div",{key:t.id,class:"relative pl-10 pb-4"},[e("div",mt,[pt,e("div",_t,[e("div",vt,[e("p",ht,m(t.procedure),1),e("span",xt,m(t.created_at),1)])])])]))),128))])])):j("",!0)])])):j("",!0)])]),_:1})]),_:1},8,["activeIndex"])]),_:1})])]),i(n(J),{position:"top-center"}),i(Y)]))}},wt=B(ft,[["__scopeId","data-v-46ec5606"]]);export{wt as default};
