import{_ as S,O as U,v as B,i as l,o as x,c as y,a as t,P as f,b,h as i,g as o,p as N,F as O,A as R,Q as j,S as z,J as w,C as A,s as E}from"./index-b48caa78.js";const L={class:"max-w-5xl mx-auto p-6",dir:"rtl"},P={class:"bg-white rounded-2xl shadow-2xl overflow-hidden"},J={class:"p-8"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W={key:0,class:"space-y-4"},q=["src"],G={key:1,class:"space-y-4"},H={class:"flex justify-center gap-6 pt-10"},K={__name:"create",setup(X){const _=U(),r=B(),d=l(""),u=l(""),p=l(null),c=l(null),m=l(null),I=l([]),v=l(!1);l(!1);const g=l(!1),C=a=>{a.preventDefault(),v.value=!0},F=()=>{v.value=!1},M=a=>{a.preventDefault(),v.value=!1;const e=a.dataTransfer.files[0];e&&e.type.startsWith("image/")?D(e):r.add({severity:"warn",summary:"غير مدعوم",detail:"يرجى رفع صورة فقط",life:3e3})},D=a=>{if(a.size>10*1024*1024){r.add({severity:"error",summary:"حجم كبير",detail:"الحد الأقصى 10 ميجابايت",life:4e3});return}c.value=a;const e=new FileReader;e.onload=s=>m.value=s.target.result,e.readAsDataURL(a)},T=()=>{c.value=null,m.value=null},$=async()=>{var e,s,h,k;if(!((e=d.value)!=null&&e.trim())){r.add({severity:"error",summary:"مطلوب",detail:"عنوان المقال مطلوب",life:3e3});return}if(!((s=u.value)!=null&&s.trim())){r.add({severity:"error",summary:"مطلوب",detail:"محتوى المقال مطلوب",life:3e3});return}if(!c.value){r.add({severity:"error",summary:"مطلوب",detail:"يرجى رفع الصورة الرئيسية",life:3e3});return}g.value=!0;const a=new FormData;if(a.append("title",d.value.trim()),a.append("content",u.value.trim()),p.value){const n=new Date(p.value);a.append("date",n.toISOString().split("T")[0])}a.append("post_main_image",c.value),I.value.forEach((n,V)=>{a.append("post_images[]",n.file)});try{const n=await E.post("/api/post",a,{headers:{"Content-Type":"multipart/form-data"}});r.add({severity:"success",summary:"تم بنجاح!",detail:"تم إنشاء المقال بنجاح",life:4e3}),setTimeout(()=>{_.push({name:"posts"})},1500)}catch(n){const V=((k=(h=n.response)==null?void 0:h.data)==null?void 0:k.message)||"فشل إنشاء المقال";r.add({severity:"error",summary:"خطأ",detail:V,life:6e3}),console.error("Create post error:",n)}finally{g.value=!1}};return(a,e)=>(x(),y(O,null,[t("div",L,[t("div",P,[e[10]||(e[10]=t("div",{class:"bg-gradient-to-l from-[#1d1a1a] to-[#474444] px-8 py-7"},[t("h1",{class:"text-3xl font-bold text-white text-center"}," إضافة مقال جديد "),t("p",{class:"text-center text-white/90 mt-2 text-lg"},"اكتب مقالك وأضف الصور المناسبة")],-1)),t("div",J,[t("form",{onSubmit:f($,["prevent"]),class:"space-y-10"},[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[b(" عنوان المقال "),t("span",{class:"text-red-500"},"*")],-1)),i(o(R),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),placeholder:"مثال: كيف تبني مدونة احترافية في 2026؟",class:"w-full text-lg py-3"},null,8,["modelValue"])]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[b(" محتوى المقال "),t("span",{class:"text-red-500"},"*")],-1)),i(o(j),{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),rows:"10",placeholder:"اكتب محتوى المقال هنا...",class:"w-full text-base"},null,8,["modelValue"])]),t("div",Q,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"}," تاريخ النشر ",-1)),i(o(z),{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),dateFormat:"yy-mm-dd",placeholder:"اختر تاريخ النشر (اختياري)",class:"w-full",showIcon:"",iconDisplay:"input"},null,8,["modelValue"])])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-bold text-gray-700 mb-3"},[b(" الصورة الرئيسية "),t("span",{class:"text-red-500"},"*")],-1)),t("div",{onDragover:f(C,["prevent"]),onDragleave:f(F,["prevent"]),onDrop:f(M,["prevent"]),class:N(["relative border-3 border-dashed rounded-2xl p-10 text-center cursor-pointer transition-all",v.value?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-gray-400"])},[t("input",{type:"file",accept:"image/*",onChange:e[3]||(e[3]=s=>D(s.target.files[0])),class:"absolute inset-0 opacity-0 cursor-pointer"},null,32),m.value?(x(),y("div",W,[t("img",{src:m.value,alt:"الصورة الرئيسية",class:"mx-auto max-h-96 rounded-xl shadow-lg object-cover"},null,8,q),i(o(w),{type:"button",label:"إزالة الصورة",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:T})])):(x(),y("div",G,[...e[8]||(e[8]=[t("i",{class:"pi pi-image text-6xl text-gray-400"},null,-1),t("p",{class:"text-xl font-bold"},"اسحب الصورة الرئيسية هنا أو اضغط للرفع",-1),t("p",{class:"text-sm text-gray-500"},"المقاس الموصى: 1200×675 • الحد الأقصى 10 ميجابايت",-1)])]))],34)]),t("div",H,[i(o(w),{type:"button",label:"إلغاء",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:e[4]||(e[4]=s=>o(_).back()),disabled:g.value,class:"px-10 py-3 text-lg"},null,8,["disabled"]),i(o(w),{type:"submit",label:"نشر المقال",icon:"pi pi-check",loading:g.value,class:"px-12 py-3 text-lg font-bold"},null,8,["loading"])])],32)])])]),i(o(A),{position:"top-right"})],64))}},Z=S(K,[["__scopeId","data-v-33872cfc"]]);export{Z as default};
