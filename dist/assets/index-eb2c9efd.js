import{_ as D,k as B,l as N,M as T,i as n,w as A,j as E,p as I,o as f,c as b,a,h as o,q as l,g as t,s as $,v as M,E as v,x as q,y as G,z as S,A as U,B as d,b as z,t as _,D as C,I as F}from"./index-dab9be7b.js";const K={class:"grid",dir:"rtl"},O={class:"col-12"},Q={class:"card p-4 shadow-2 border-round"},H={class:"flex gap-3 align-items-center"},J={class:"p-input-icon-left"},W=["src"],X={key:1,class:"w-16 h-16 bg-gray-200 border-2 border-dashed rounded-lg flex items-center justify-center mx-auto"},Y={class:"line-clamp-3 text-sm text-gray-700"},Z={class:"flex gap-2 justify-content-center"},ee={class:"text-center py-12 text-gray-500"},te={class:"flex flex-column align-items-center py-12"},se={__name:"index",setup(ae){const p=B(),R=N(),y=T(),x=n(!0),h=n([]),u=n(""),w=n(null),m=n(1),c=n(10),P=n(0),L=n(1),g=async()=>{x.value=!0;try{const e=(await $.get("/api/game",{params:{page:m.value,limit:c.value,search:u.value||void 0}})).data;if(e.success){h.value=e.data||[];const i=e.pagination||{};P.value=i.total||0,L.value=i.last_page||1,m.value=i.current_page||1,c.value=i.per_page||10}else p.add({severity:"warn",summary:"تحذير",detail:e.message||"حدث خطأ غير متوقع",life:4e3})}catch(r){p.add({severity:"error",summary:"خطأ",detail:"فشل تحميل الألعاب",life:4e3}),console.error("Error fetching games:",r)}finally{x.value=!1}},k=r=>{if(!r||!Array.isArray(r)||r.length===0)return null;const e=r.find(i=>i.name==="game_image");return(e==null?void 0:e.url)||null};A([u,c],()=>{m.value=1,g()},{deep:!0});const V=r=>{m.value=r.page+1,c.value=r.rows,g()};return E(()=>{g()}),(r,e)=>{const i=I("tooltip");return f(),b("div",K,[a("div",O,[a("div",Q,[o(t(q),{class:"mb-4"},{start:l(()=>[...e[4]||(e[4]=[a("h2",{class:"text-2xl font-bold text-primary"},"إدارة الألعاب",-1)])]),end:l(()=>[a("div",H,[a("span",J,[e[5]||(e[5]=a("i",{class:"pi pi-search"},null,-1)),o(t(M),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),placeholder:"البحث بالاسم...",class:"w-full md:w-20rem"},null,8,["modelValue"])]),o(t(v),{label:"إضافة لعبة جديدة",icon:"pi pi-plus",class:"p-button-success",onClick:e[1]||(e[1]=s=>t(y).push({name:"games-create"}))})])]),_:1}),o(t(G),{position:"top-right"}),o(t(S)),o(t(F),{value:h.value,loading:x.value,dataKey:"id",selection:w.value,"onUpdate:selection":e[3]||(e[3]=s=>w.value=s),responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:!0,rows:c.value,totalRecords:P.value,rowsPerPageOptions:[5,10,20,50,100],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"عرض {first} إلى {last} من إجمالي {totalRecords} لعبة",onPage:V,dir:"rtl"},{empty:l(()=>[a("div",ee,[e[7]||(e[7]=a("i",{class:"pi pi-box text-6xl mb-4 text-gray-300"},null,-1)),e[8]||(e[8]=a("p",{class:"text-2xl font-bold"},"لا توجد ألعاب حاليًا",-1)),e[9]||(e[9]=a("p",{class:"text-lg mt-2"},"ابدأ بإضافة أول لعبة في متجرك",-1)),o(t(v),{label:"إضافة لعبة جديدة",icon:"pi pi-plus",class:"mt-4 p-button-success",onClick:e[2]||(e[2]=s=>t(y).push({name:"products-create"}))})])]),loading:l(()=>[a("div",te,[o(t(U),{style:{width:"60px",height:"60px"}}),e[10]||(e[10]=a("p",{class:"mt-4 text-xl font-medium text-gray-600"},"جاري تحميل الألعاب...",-1))])]),default:l(()=>[o(t(d),{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(t(d),{field:"id",header:"المعرف",sortable:"",style:{"min-width":"5rem"}},{body:l(({data:s})=>[z(" #"+_(s.id),1)]),_:1}),o(t(d),{header:"الصورة",style:{"min-width":"8rem","text-align":"center"}},{body:l(({data:s})=>[k(s.media)?(f(),b("img",{key:0,src:k(s.media),alt:"صورة اللعبة",class:"w-16 h-16 object-cover rounded-lg shadow-md border border-gray-200"},null,8,W)):(f(),b("div",X,[...e[6]||(e[6]=[a("i",{class:"pi pi-image text-gray-400 text-2xl"},null,-1)])]))]),_:1}),o(t(d),{field:"name",header:"اسم اللعبة",sortable:"",style:{"min-width":"16rem"}},{body:l(({data:s})=>[a("strong",null,_(s.name),1)]),_:1}),o(t(d),{header:"الوصف",style:{"min-width":"20rem"}},{body:l(({data:s})=>[a("div",Y,_(s.description||"لا يوجد وصف"),1)]),_:1}),o(t(d),{header:"الإجراءات",style:{"min-width":"12rem","text-align":"center"}},{body:l(({data:s})=>[a("div",Z,[C(o(t(v),{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning p-button-text p-button-sm",onClick:j=>t(y).push({name:"games-edit",params:{id:s.id}})},null,8,["onClick"]),[[i,"تعديل",void 0,{top:!0}]]),C(o(t(v),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text p-button-sm",onClick:j=>t(R).require({message:"هل أنت متأكد من حذف هذه اللعبة نهائيًا؟",header:"تأكيد الحذف",icon:"pi pi-exclamation-triangle",acceptLabel:"نعم، احذف",rejectLabel:"إلغاء",accept:async()=>{try{await t($).delete(`/api/game/${s.id}`),t(p).add({severity:"success",summary:"تم",detail:"تم حذف اللعبة بنجاح",life:3e3}),g()}catch{t(p).add({severity:"error",summary:"فشل",detail:"تعذر حذف اللعبة",life:4e3})}}})},null,8,["onClick"]),[[i,"حذف",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","selection","rows","totalRecords"])])])])}}},le=D(se,[["__scopeId","data-v-f197de04"]]);export{le as default};
