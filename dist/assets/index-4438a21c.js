import{_ as T,v as j,w as E,O as I,i as n,x as G,j as M,y as O,o as S,c as U,a as l,h as a,z as i,g as s,s as P,A as q,J as v,B as z,C as A,D as F,E as J,G as d,b as k,t as g,I as C,L as K}from"./index-063be7f6.js";const Q={class:"grid",dir:"rtl"},H={class:"col-12"},W={class:"card p-4 shadow-2 border-round"},X={class:"flex gap-3 align-items-center"},Y={class:"p-input-icon-left"},Z={class:"line-clamp-2 text-sm text-600"},ee={class:"flex gap-2 justify-content-center"},te={class:"text-center py-8 text-gray-500"},se={class:"flex flex-column align-items-center py-8"},ae={__name:"index",setup(le){const b=j(),$=E(),x=I(),y=n(!0),_=n([]),p=n(""),h=n(null),u=n(1),c=n(10),w=n(0),L=n(1),R=n(0),B=n(0),f=n(null),m=async()=>{y.value=!0;try{const e=(await P.get("/api/banner",{params:{page:u.value,limit:c.value,search:p.value}})).data;if(e.success){_.value=e.data||[];const o=e.pagination||{};w.value=o.total||0,L.value=o.last_page||1,R.value=o.from||0,B.value=o.to||0,u.value=o.current_page||1,c.value=o.per_page||10}}catch(r){b.add({severity:"error",summary:"خطأ",detail:"فشل تحميل البانرات",life:4e3}),console.error("Error fetching banners:",r)}finally{y.value=!1}},V=r=>{$.require({message:"هل أنت متأكد من حذف هذا البانر؟ هذا الإجراء لا يمكن التراجع عنه.",header:"تأكيد الحذف",icon:"pi pi-exclamation-triangle",acceptLabel:"نعم، احذف",rejectLabel:"إلغاء",acceptClass:"p-button-danger",accept:async()=>{var e,o;f.value=r;try{await P.delete(`/api/banner/${r}`),b.add({severity:"success",summary:"تم الحذف",detail:"تم حذف البانر بنجاح",life:3e3}),await m()}catch(t){b.add({severity:"error",summary:"خطأ",detail:((o=(e=t.response)==null?void 0:e.data)==null?void 0:o.message)||"فشل حذف البانر",life:5e3})}finally{f.value=null}}})};G([p,c],()=>{u.value=1,m()});const D=r=>{u.value=r.page+1,c.value=r.rows,m()};return M(()=>{m()}),(r,e)=>{const o=O("tooltip");return S(),U("div",Q,[l("div",H,[l("div",W,[a(s(z),{class:"mb-4"},{start:i(()=>[...e[4]||(e[4]=[l("h2",{class:"text-2xl font-bold text-primary"},"إدارة البانرات الترويجية",-1)])]),end:i(()=>[l("div",X,[l("span",Y,[e[5]||(e[5]=l("i",{class:"pi pi-search"},null,-1)),a(s(q),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),placeholder:"ابحث في البانرات...",class:"w-full md:w-20rem"},null,8,["modelValue"])]),a(s(v),{label:"إضافة بانر جديد",icon:"pi pi-plus",class:"p-button-success",onClick:e[1]||(e[1]=t=>s(x).push({name:"banner-create"}))})])]),_:1}),a(s(A),{position:"top-right"}),a(s(F)),a(s(K),{value:_.value,loading:y.value,dataKey:"id",selection:h.value,"onUpdate:selection":e[3]||(e[3]=t=>h.value=t),responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:!0,rows:c.value,totalRecords:w.value,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"عرض {first} إلى {last} من {totalRecords} بانر",onPage:D,dir:"rtl"},{empty:i(()=>[l("div",te,[e[6]||(e[6]=l("i",{class:"pi pi-image text-6xl mb-4 text-300"},null,-1)),e[7]||(e[7]=l("p",{class:"text-xl font-bold"},"لا توجد بانرات حالياً",-1)),e[8]||(e[8]=l("p",{class:"text-600 mb-4"},"ابدأ بإنشاء أول بانر ترويجي لموقعك",-1)),a(s(v),{label:"إنشاء أول بانر",icon:"pi pi-plus",class:"p-button-success",onClick:e[2]||(e[2]=t=>s(x).push({name:"banner-create"}))})])]),loading:i(()=>[l("div",se,[a(s(J),{style:{width:"60px",height:"60px"}}),e[9]||(e[9]=l("p",{class:"mt-4 text-lg text-600 font-medium"},"جاري تحميل البانرات...",-1))])]),default:i(()=>[a(s(d),{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(s(d),{field:"id",header:"المعرف",sortable:"",style:{"min-width":"4rem"}},{body:i(({data:t})=>[k(" #"+g(t.id),1)]),_:1}),a(s(d),{field:"title",header:"العنوان",sortable:"",style:{"min-width":"14rem"}},{body:i(({data:t})=>[l("strong",null,g(t.title),1)]),_:1}),a(s(d),{field:"subtitle",header:"العنوان الفرعي",sortable:"",style:{"min-width":"12rem"}},{body:i(({data:t})=>[k(g(t.subtitle||"—"),1)]),_:1}),a(s(d),{header:"الوصف",style:{"min-width":"16rem"}},{body:i(({data:t})=>[l("div",Z,g(t.description||"لا يوجد وصف"),1)]),_:1}),a(s(d),{header:"الإجراءات",style:{"min-width":"12rem","text-align":"center"}},{body:i(({data:t})=>[l("div",ee,[C(a(s(v),{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning p-button-text",onClick:N=>s(x).push({name:"banner-edit",params:{id:t.id}})},null,8,["onClick"]),[[o,"تعديل",void 0,{top:!0}]]),C(a(s(v),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text",loading:f.value===t.id,onClick:N=>V(t.id)},null,8,["loading","onClick"]),[[o,"حذف",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","selection","rows","totalRecords"])])])])}}},ne=T(ae,[["__scopeId","data-v-8c07a238"]]);export{ne as default};
