import{_ as z,O as S,M as q,v as A,i as o,j as L,o as u,c as v,a as t,t as F,g as s,P as y,b as g,h as i,p as O,K as P,q as E,F as J,s as $,A as N,Q as K,J as _,C as Q}from"./index-b48caa78.js";const W={class:"max-w-4xl mx-auto p-6",dir:"rtl"},G={class:"bg-white rounded-2xl shadow-2xl overflow-hidden"},H={class:"bg-gradient-to-l from-[#2c3e50] to-[#1a2530] px-8 py-7"},X={class:"text-3xl font-bold text-white text-center"},Y={class:"p-8"},Z={key:0,class:"text-center py-20"},ee={key:0,class:"space-y-6"},te=["src"],ae={class:"text-center"},le={class:"text-sm font-medium text-gray-600"},se={class:"flex justify-center gap-4"},oe={class:"cursor-pointer"},ne={key:1,class:"space-y-5"},re={class:"flex justify-center gap-6 pt-12"},ie={__name:"edit",setup(de){const k=S(),h=q(),n=A(),c=o(""),b=o(""),p=o(""),D=o(""),r=o(null),m=o(""),f=o(!1),V=o(!0),x=o(!1),T=async()=>{var a;try{const l=(await $.get(`/api/banner/${h.params.id}`)).data.data;c.value=l.title||"",b.value=l.subtitle||"",p.value=l.description||"";const d=(a=l.media)==null?void 0:a.find(w=>w.name==="banner_image");d&&d.url&&(D.value=d.url,m.value=d.url)}catch(e){n.add({severity:"error",summary:"خطأ",detail:"فشل تحميل بيانات البانر",life:5e3}),console.error("خطأ في جلب البانر:",e)}finally{V.value=!1}},U=a=>{a.preventDefault(),f.value=!0},j=()=>{f.value=!1},I=a=>{a.preventDefault(),f.value=!1;const e=a.dataTransfer.files[0];e&&e.type.startsWith("image/")?B(e):n.add({severity:"warn",summary:"ملف غير صالح",detail:"يرجى رفع صورة فقط",life:3e3})},C=a=>{const e=a.target.files[0];e&&B(e)},B=a=>{if(a.size>5*1024*1024){n.add({severity:"warn",summary:"الحجم كبير جدًا",detail:"يجب ألا يتجاوز حجم الصورة 5 ميجابايت",life:4e3});return}r.value=a;const e=new FileReader;e.onload=l=>{m.value=l.target.result},e.readAsDataURL(a)},M=()=>{r.value=null,m.value=D.value;const a=document.querySelector('input[type="file"]');a&&(a.value="")},R=async()=>{var e,l;if(!c.value.trim()){n.add({severity:"error",summary:"حقل مطلوب",detail:"العنوان مطلوب",life:3e3});return}if(!p.value.trim()){n.add({severity:"error",summary:"حقل مطلوب",detail:"الوصف مطلوب",life:3e3});return}x.value=!0;const a=new FormData;a.append("title",c.value),a.append("subtitle",b.value||""),a.append("description",p.value),r.value&&a.append("banner_image",r.value),a.append("_method","post");try{await $.post(`/api/banner/${h.params.id}`,a,{headers:{"Content-Type":"multipart/form-data"}}),n.add({severity:"success",summary:"تم بنجاح!",detail:"تم تحديث البانر بنجاح",life:4e3}),setTimeout(()=>{k.push({name:"banners"})},1500)}catch(d){const w=((l=(e=d.response)==null?void 0:e.data)==null?void 0:l.message)||"فشل تحديث البانر";n.add({severity:"error",summary:"خطأ",detail:w,life:5e3})}finally{x.value=!1}};return L(()=>{T()}),(a,e)=>(u(),v(J,null,[t("div",W,[t("div",G,[t("div",H,[t("h1",X," تعديل البانر رقم #"+F(s(h).params.id),1),e[4]||(e[4]=t("p",{class:"text-center text-white/80 mt-2 text-lg"},"قم بتحديث تفاصيل البانر الترويجي",-1))]),t("div",Y,[V.value?(u(),v("div",Z,[...e[5]||(e[5]=[t("i",{class:"pi pi-spin pi-spinner text-7xl text-blue-600"},null,-1),t("p",{class:"mt-6 text-xl font-medium text-gray-600"},"جاري تحميل بيانات البانر...",-1)])])):(u(),v("form",{key:1,onSubmit:y(R,["prevent"]),class:"space-y-9"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[g(" العنوان "),t("span",{class:"text-red-500"},"*")],-1)),i(s(N),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),placeholder:"أدخل عنوان البانر",class:"w-full text-lg py-3"},null,8,["modelValue"])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[g(" العنوان الفرعي "),t("small",{class:"text-gray-500 font-normal"},"(اختياري)")],-1)),i(s(N),{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),placeholder:"أدخل العنوان الفرعي",class:"w-full py-3"},null,8,["modelValue"])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[g(" الوصف "),t("span",{class:"text-red-500"},"*")],-1)),i(s(K),{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),rows:"6",placeholder:"أدخل وصف البانر الترويجي...",class:"w-full"},null,8,["modelValue"])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-bold text-gray-700 mb-3"}," صورة البانر الحالية ",-1)),t("div",{onDragover:y(U,["prevent"]),onDragleave:y(j,["prevent"]),onDrop:y(I,["prevent"]),class:O(["relative border-3 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all duration-300 shadow-md",f.value?"border-blue-500 bg-blue-50/60":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"])},[t("input",{type:"file",accept:"image/*",onChange:C,class:"absolute inset-0 opacity-0 cursor-pointer z-10"},null,32),m.value?(u(),v("div",ee,[t("img",{src:m.value,alt:"معاينة البانر",class:"mx-auto max-h-96 rounded-xl shadow-2xl object-cover border-4 border-white"},null,8,te),t("div",ae,[t("p",le,F(r.value?"تم اختيار صورة جديدة (سيتم استبدال الصورة الحالية)":"الصورة الحالية للبانر"),1)]),t("div",se,[r.value?(u(),P(s(_),{key:0,type:"button",label:"إلغاء الصورة الجديدة",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:y(M,["stop"])})):E("",!0),t("label",oe,[i(s(_),{label:r.value?"تغيير الصورة مرة أخرى":"استبدال الصورة",icon:"pi pi-camera",outlined:""},null,8,["label"]),t("input",{type:"file",accept:"image/*",onChange:C,class:"hidden"},null,32)])])])):(u(),v("div",ne,[...e[9]||(e[9]=[t("i",{class:"pi pi-image text-7xl text-gray-400"},null,-1),t("p",{class:"text-xl font-bold text-gray-700"},[t("span",{class:"text-blue-600 font-extrabold"},"اضغط أو اسحب"),g(" لاستبدال الصورة ")],-1)])]))],34)]),t("div",re,[i(s(_),{type:"button",label:"إلغاء",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:e[3]||(e[3]=l=>s(k).back()),disabled:x.value,class:"px-10 py-3 text-lg"},null,8,["disabled"]),i(s(_),{type:"submit",label:"حفظ التعديلات",icon:"pi pi-check",loading:x.value,class:"px-12 py-3 text-lg font-bold"},null,8,["loading"])])],32))])])]),i(s(Q),{position:"top-right"})],64))}},ce=z(ie,[["__scopeId","data-v-4625b302"]]);export{ce as default};
