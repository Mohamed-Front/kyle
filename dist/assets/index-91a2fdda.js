import{_ as j,v as D,w as M,O as B,i as n,x as N,j as T,y as E,o as f,c as b,a,h as r,z as i,g as t,s as k,A as I,J as v,B as G,C as O,D as S,E as U,G as c,b as q,t as $,I as C,L as z}from"./index-063be7f6.js";const A={class:"grid",dir:"rtl"},F={class:"col-12"},J={class:"card p-4 shadow-2 border-round"},K={class:"flex gap-3 align-items-center"},Q={class:"p-input-icon-left"},H=["src"],W={key:1,class:"w-16 h-16 bg-gray-200 border-2 border-dashed rounded-full flex items-center justify-center mx-auto"},X={class:"flex gap-2 justify-content-center"},Y={class:"text-center py-12 text-gray-500"},Z={class:"flex flex-column align-items-center py-12"},ee={__name:"index",setup(te){const u=D(),L=M(),y=B(),x=n(!0),_=n([]),p=n(""),h=n(null),m=n(1),d=n(10),w=n(0),g=async()=>{x.value=!0;try{const e=(await k.get("/api/team",{params:{page:m.value,limit:d.value,search:p.value}})).data;if(e.success){_.value=e.data||[];const o=e.pagination||{};w.value=o.total||0,m.value=o.current_page||1,d.value=o.per_page||10}else u.add({severity:"warn",summary:"تحذير",detail:e.message||"لا توجد بيانات",life:4e3})}catch(l){u.add({severity:"error",summary:"خطأ",detail:"فشل تحميل أعضاء الفريق",life:4e3}),console.error("Error fetching team members:",l)}finally{x.value=!1}},P=l=>{var o;if(!l||l.length===0)return null;const e=l.find(s=>s.name==="profile"||s.name==="avatar");return(e==null?void 0:e.url)||((o=l[0])==null?void 0:o.url)||null};N([p,d],()=>{m.value=1,g()});const R=l=>{m.value=l.page+1,d.value=l.rows,g()};return T(()=>{g()}),(l,e)=>{const o=E("tooltip");return f(),b("div",A,[a("div",F,[a("div",J,[r(t(G),{class:"mb-4"},{start:i(()=>[...e[4]||(e[4]=[a("h2",{class:"text-2xl font-bold text-primary"},"إدارة أعضاء الفريق",-1)])]),end:i(()=>[a("div",K,[a("span",Q,[e[5]||(e[5]=a("i",{class:"pi pi-search"},null,-1)),r(t(I),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),placeholder:"البحث بالاسم...",class:"w-full md:w-20rem"},null,8,["modelValue"])]),r(t(v),{label:"إضافة عضو جديد",icon:"pi pi-plus",class:"p-button-success",onClick:e[1]||(e[1]=s=>t(y).push({name:"team-create"}))})])]),_:1}),r(t(O),{position:"top-right"}),r(t(S)),r(t(z),{value:_.value,loading:x.value,dataKey:"id",selection:h.value,"onUpdate:selection":e[3]||(e[3]=s=>h.value=s),responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:!0,rows:d.value,totalRecords:w.value,rowsPerPageOptions:[5,10,20,50,100],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"عرض {first} إلى {last} من إجمالي {totalRecords} عضو",onPage:R,dir:"rtl"},{empty:i(()=>[a("div",Y,[e[7]||(e[7]=a("i",{class:"pi pi-users text-6xl mb-4 text-gray-300"},null,-1)),e[8]||(e[8]=a("p",{class:"text-2xl font-bold"},"لا يوجد أعضاء في الفريق حاليًا",-1)),e[9]||(e[9]=a("p",{class:"text-lg mt-2"},"ابدأ بإضافة أول عضو في فريقك",-1)),r(t(v),{class:"mt-4 p-button-success",label:"إضافة عضو جديد",icon:"pi pi-plus",onClick:e[2]||(e[2]=s=>t(y).push({name:"team-create"}))})])]),loading:i(()=>[a("div",Z,[r(t(U),{style:{width:"60px",height:"60px"}}),e[10]||(e[10]=a("p",{class:"mt-4 text-xl font-medium text-gray-600"},"جاري تحميل أعضاء الفريق...",-1))])]),default:i(()=>[r(t(c),{selectionMode:"multiple",headerStyle:"width: 3rem"}),r(t(c),{field:"id",header:"المعرف",sortable:"",style:{"min-width":"4rem"}},{body:i(({data:s})=>[q(" #"+$(s.id),1)]),_:1}),r(t(c),{header:"الصورة",style:{"min-width":"8rem","text-align":"center"}},{body:i(({data:s})=>[P(s.media)?(f(),b("img",{key:0,src:P(s.media),alt:"صورة العضو",class:"w-16 h-16 object-cover rounded-full shadow-md border-2 border-gray-200"},null,8,H)):(f(),b("div",W,[...e[6]||(e[6]=[a("i",{class:"pi pi-user text-gray-400 text-3xl"},null,-1)])]))]),_:1}),r(t(c),{field:"name",header:"اسم العضو",sortable:"",style:{"min-width":"14rem"}},{body:i(({data:s})=>[a("strong",null,$(s.name),1)]),_:1}),r(t(c),{header:"الإجراءات",style:{"min-width":"12rem","text-align":"center"}},{body:i(({data:s})=>[a("div",X,[C(r(t(v),{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning p-button-text p-button-sm",onClick:V=>t(y).push({name:"team-edit",params:{id:s.id}})},null,8,["onClick"]),[[o,"تعديل",void 0,{top:!0}]]),C(r(t(v),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text p-button-sm",onClick:V=>t(L).require({message:"هل أنت متأكد من حذف هذا العضو نهائيًا؟",header:"تأكيد الحذف",icon:"pi pi-exclamation-triangle",acceptLabel:"نعم، احذف",rejectLabel:"إلغاء",accept:async()=>{try{await t(k).delete(`/api/team/${s.id}`),t(u).add({severity:"success",summary:"تم الحذف",detail:"تم حذف العضو بنجاح",life:3e3}),g()}catch{t(u).add({severity:"error",summary:"فشل الحذف",detail:"حدث خطأ أثناء حذف العضو",life:4e3})}}})},null,8,["onClick"]),[[o,"حذف",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","selection","rows","totalRecords"])])])])}}},re=j(ee,[["__scopeId","data-v-41f48887"]]);export{re as default};
