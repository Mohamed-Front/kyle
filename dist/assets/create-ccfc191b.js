import{_ as B,M as G,k as I,i as n,o as b,c as x,a as t,N as u,b as f,h as o,H as T,g as l,L,v as R,O as U,E as y,y as A,s as M}from"./index-dab9be7b.js";const O={class:"max-w-4xl mx-auto p-6",dir:"rtl"},S={class:"bg-white rounded-2xl shadow-2xl overflow-hidden"},W={class:"p-8"},q={key:0,class:"space-y-6"},H=["src"],J={class:"flex justify-center gap-4"},K={class:"cursor-pointer"},Q={key:1,class:"space-y-5"},X={class:"flex justify-center gap-6 pt-12"},Y={__name:"create",setup(Z){const _=G(),r=I(),i=n(""),p=n(""),c=n(null),m=n(null),v=n(!1),g=n(!1),N=a=>{a.preventDefault(),v.value=!0},P=()=>{v.value=!1},E=a=>{a.preventDefault(),v.value=!1;const e=a.dataTransfer.files[0];e&&e.type.startsWith("image/")?w(e):r.add({severity:"warn",summary:"ملف غير صالح",detail:"يرجى رفع صورة فقط",life:3e3})},h=a=>{const e=a.target.files[0];e&&w(e)},w=a=>{if(a.size>10*1024*1024){r.add({severity:"warn",summary:"الحجم كبير",detail:"يجب ألا يتجاوز حجم الصورة 10 ميجابايت",life:4e3});return}c.value=a;const e=new FileReader;e.onload=s=>{m.value=s.target.result},e.readAsDataURL(a)},$=()=>{c.value=null,m.value=null;const a=document.querySelector('input[type="file"]');a&&(a.value="")},j=async()=>{var e,s,D,k,V,C,F;if(!((e=i.value)!=null&&e.trim())){r.add({severity:"error",summary:"حقل مطلوب",detail:"اسم اللعبة مطلوب",life:3e3});return}if(!((s=p.value)!=null&&s.trim())){r.add({severity:"error",summary:"حقل مطلوب",detail:"الوصف مطلوب",life:3e3});return}if(!c.value){r.add({severity:"error",summary:"حقل مطلوب",detail:"يرجى رفع صورة اللعبة",life:3e3});return}g.value=!0;const a=new FormData;a.append("name",i.value.trim()),a.append("description",p.value.trim()),a.append("game_image",c.value);try{const d=await M.post("/api/game",a,{headers:{"Content-Type":"multipart/form-data"}});r.add({severity:"success",summary:"تم بنجاح!",detail:"تم إضافة اللعبة بنجاح",life:4e3}),setTimeout(()=>{_.push({name:"games"})},1500)}catch(d){const z=((k=(D=d.response)==null?void 0:D.data)==null?void 0:k.message)||((C=(V=d.response)==null?void 0:V.data)==null?void 0:C.error)||"فشل إضافة اللعبة";r.add({severity:"error",summary:"فشل الإضافة",detail:z,life:5e3}),console.error("Error adding game:",((F=d.response)==null?void 0:F.data)||d)}finally{g.value=!1}};return(a,e)=>(b(),x(L,null,[t("div",O,[t("div",S,[e[7]||(e[7]=t("div",{class:"bg-gradient-to-l from-[#1d1a1a] to-[#474444] px-8 py-7"},[t("h1",{class:"text-3xl font-bold text-white text-center"}," إضافة لعبة جديدة "),t("p",{class:"text-center text-white/90 mt-2 text-lg"}," أدخل تفاصيل اللعبة لإضافتها إلى المكتبة ")],-1)),t("div",W,[t("form",{onSubmit:u(j,["prevent"]),class:"space-y-9"},[t("div",null,[e[3]||(e[3]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[f(" اسم اللعبة "),t("span",{class:"text-red-500"},"*")],-1)),o(l(R),{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),placeholder:"مثال: GTA V - Premium Edition",class:T(["w-full text-lg py-3",{"p-invalid":!i.value&&a.submitted}])},null,8,["modelValue","class"])]),t("div",null,[e[4]||(e[4]=t("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[f(" وصف اللعبة "),t("span",{class:"text-red-500"},"*")],-1)),o(l(U),{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),rows:"7",placeholder:"اكتب وصفًا جذابًا عن اللعبة، القصة، المميزات، متطلبات التشغيل...",class:"w-full text-base"},null,8,["modelValue"])]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-bold text-gray-700 mb-3"},[f(" صورة اللعبة (الغلاف) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",{onDragover:u(N,["prevent"]),onDragleave:u(P,["prevent"]),onDrop:u(E,["prevent"]),class:T(["relative border-3 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all duration-300 shadow-md",v.value?"border-blue-600 bg-blue-50/70":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"])},[t("input",{type:"file",accept:"image/*",onChange:h,class:"absolute inset-0 opacity-0 cursor-pointer z-10"},null,32),m.value?(b(),x("div",q,[t("img",{src:m.value,alt:"معاينة غلاف اللعبة",class:"mx-auto max-h-96 rounded-xl shadow-2xl object-cover border-4 border-white"},null,8,H),t("div",J,[o(l(y),{type:"button",label:"إزالة الصورة",icon:"pi pi-trash",severity:"danger",outlined:"",onClick:u($,["stop"])}),t("label",K,[o(l(y),{label:"تغيير الصورة",icon:"pi pi-camera",outlined:""}),t("input",{type:"file",accept:"image/*",onChange:h,class:"hidden"},null,32)])])])):(b(),x("div",Q,[...e[5]||(e[5]=[t("i",{class:"pi pi-image text-7xl text-gray-400"},null,-1),t("div",null,[t("p",{class:"text-xl font-bold text-gray-700"},[t("span",{class:"text-blue-600 font-extrabold"},"اضغط للرفع"),f(" أو اسحب وأفلت الصورة هنا ")]),t("p",{class:"text-sm text-gray-500 mt-2"}," المقاس الموصى: 800×1200 أو 1080×1920 • صيغ PNG، JPG، WebP • الحد الأقصى 10 ميجابايت ")],-1)])]))],34)]),t("div",X,[o(l(y),{type:"button",label:"إلغاء",icon:"pi pi-times",severity:"secondary",outlined:"",onClick:e[2]||(e[2]=s=>l(_).back()),disabled:g.value,class:"px-10 py-3 text-lg"},null,8,["disabled"]),o(l(y),{type:"submit",label:"إضافة اللعبة",icon:"pi pi-plus",loading:g.value,class:"px-12 py-3 text-lg font-bold"},null,8,["loading"])])],32)])])]),o(l(A),{position:"top-right"})],64))}},te=B(Y,[["__scopeId","data-v-2609a6db"]]);export{te as default};
