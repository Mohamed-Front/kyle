import{_ as S,v as B,w as E,O as N,i as d,x as T,j as G,y as I,o as f,c as b,a as l,h as a,z as r,g as t,s as M,A as O,J as m,B as U,C as q,D as z,E as A,G as i,b as F,t as g,H,I as $,L as J}from"./index-b48caa78.js";const K={class:"grid",dir:"rtl"},Q={class:"col-12"},W={class:"card p-4 shadow-2 border-round"},X={class:"flex gap-3 align-items-center"},Y={class:"p-input-icon-left"},Z=["src"],ee={key:1,class:"w-16 h-16 bg-gray-200 border-2 border-dashed rounded-lg flex items-center justify-center mx-auto"},te={class:"line-clamp-3 text-sm text-gray-700"},se={class:"text-sm"},ae={class:"flex gap-2 justify-content-center"},oe={class:"text-center py-12 text-gray-500"},le={class:"flex flex-column align-items-center py-12"},re={__name:"index",setup(ne){const _=B(),L=E(),v=N(),y=d(!0),h=d([]),u=d(""),w=d(null),p=d(1),c=d(10),P=d(0),x=async()=>{y.value=!0;try{const e=(await M.get("/api/post",{params:{page:p.value,limit:c.value,search:u.value}})).data;if(e.success){h.value=e.data||[];const n=e.pagination||{};P.value=n.total||0,p.value=n.current_page||1,c.value=n.per_page||10}}catch(o){_.add({severity:"error",summary:"خطأ",detail:"فشل تحميل المقالات",life:4e3}),console.error("Error fetching posts:",o)}finally{y.value=!1}},k=o=>{if(!o||o.length===0)return null;const e=o.find(n=>n.name==="post_main_image");return(e==null?void 0:e.url)||null},C=o=>o?new Date(o).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}):"غير محدد",R=o=>o===1?"success":"warning",D=o=>o===1?"منشور":"مسودة";T([u,c],()=>{p.value=1,x()},{deep:!0});const V=o=>{p.value=o.page+1,c.value=o.rows,x()};return G(()=>{x()}),(o,e)=>{const n=I("tooltip");return f(),b("div",K,[l("div",Q,[l("div",W,[a(t(U),{class:"mb-4"},{start:r(()=>[...e[5]||(e[5]=[l("h2",{class:"text-2xl font-bold text-primary"},"إدارة المقالات",-1)])]),end:r(()=>[l("div",X,[l("span",Y,[e[6]||(e[6]=l("i",{class:"pi pi-search"},null,-1)),a(t(O),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),placeholder:"البحث في العنوان أو المحتوى...",class:"w-full md:w-20rem"},null,8,["modelValue"])]),a(t(m),{label:"إضافة مقال جديد",icon:"pi pi-plus",class:"p-button-success",onClick:e[1]||(e[1]=s=>t(v).push({name:"post-create"}))})])]),_:1}),a(t(q),{position:"top-right"}),a(t(z)),a(t(J),{value:h.value,loading:y.value,dataKey:"id",selection:w.value,"onUpdate:selection":e[4]||(e[4]=s=>w.value=s),responsiveLayout:"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:!0,rows:c.value,totalRecords:P.value,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"عرض {first} إلى {last} من إجمالي {totalRecords} مقال",onPage:V,dir:"rtl"},{empty:r(()=>[l("div",oe,[e[8]||(e[8]=l("i",{class:"pi pi-file text-6xl mb-4 text-gray-300"},null,-1)),e[9]||(e[9]=l("p",{class:"text-2xl font-bold"},"لا توجد مقالات حاليًا",-1)),e[10]||(e[10]=l("p",{class:"text-lg mt-2"},"ابدأ بكتابة أول مقال في مدونتك",-1)),a(t(m),{label:"إضافة مقال جديد",icon:"pi pi-plus",class:"mt-4 p-button-success",onClick:e[3]||(e[3]=s=>t(v).push({name:"posts-create"}))})])]),loading:r(()=>[l("div",le,[a(t(A),{style:{width:"60px",height:"60px"}}),e[11]||(e[11]=l("p",{class:"mt-4 text-xl font-medium text-gray-600"},"جاري تحميل المقالات...",-1))])]),default:r(()=>[a(t(i),{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(t(i),{field:"id",header:"المعرف",sortable:"",style:{"min-width":"4rem"}},{body:r(({data:s})=>[F(" #"+g(s.id),1)]),_:1}),a(t(i),{header:"الصورة",style:{"min-width":"8rem","text-align":"center"}},{body:r(({data:s})=>[k(s.media)?(f(),b("img",{key:0,src:k(s.media),alt:"صورة المقال",class:"w-16 h-16 object-cover rounded-lg shadow-md border border-gray-200"},null,8,Z)):(f(),b("div",ee,[...e[7]||(e[7]=[l("i",{class:"pi pi-image text-gray-400 text-2xl"},null,-1)])]))]),_:1}),a(t(i),{field:"title",header:"عنوان المقال",sortable:"",style:{"min-width":"16rem"}},{body:r(({data:s})=>[l("strong",null,g(s.title),1)]),_:1}),a(t(i),{field:"content",header:"المحتوى",style:{"min-width":"20rem"}},{body:r(({data:s})=>[l("div",te,g(s.content||"لا يوجد محتوى"),1)]),_:1}),a(t(i),{field:"date",header:"تاريخ النشر",sortable:"",style:{"min-width":"10rem"}},{body:r(({data:s})=>[l("span",se,g(C(s.date)),1)]),_:1}),a(t(i),{field:"status",header:"الحالة",style:{"min-width":"8rem"}},{body:r(({data:s})=>[a(t(H),{severity:R(s.status),value:D(s.status),class:"text-sm"},null,8,["severity","value"])]),_:1}),a(t(i),{header:"الإجراءات",style:{"min-width":"12rem","text-align":"center"}},{body:r(({data:s})=>[l("div",ae,[$(a(t(m),{icon:"pi pi-pencil",class:"p-button-rounded p-button-warning p-button-text p-button-sm",onClick:j=>t(v).push({name:"post-edit",params:{id:s.id}})},null,8,["onClick"]),[[n,"تعديل",void 0,{top:!0}]]),$(a(t(m),{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text p-button-sm",onClick:e[2]||(e[2]=j=>t(L).require({message:"هل أنت متأكد من حذف هذا المقال نهائيًا؟",header:"تأكيد الحذف",icon:"pi pi-exclamation-triangle",acceptLabel:"نعم، احذف",rejectLabel:"إلغاء",accept:()=>{t(_).add({severity:"info",summary:"قريبًا",detail:"خاصية الحذف قيد التطوير",life:3e3})}}))},null,512),[[n,"حذف",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","selection","rows","totalRecords"])])])])}}},de=S(re,[["__scopeId","data-v-e2d72763"]]);export{de as default};
